#!/bin/sh

# Run ktlint check and format
echo "Running ktlint check and format..."

# Run ktlint format to fix issues
./gradlew ktlintFormat

# Check if ktlint made any changes
if ! git diff --quiet; then
    echo "ktlint made formatting changes. Staging them..."
    # Stage any changes made by ktlint
    git add -A
fi

# Run ktlint check to ensure everything passes
./gradlew ktlintCheck

# Exit with ktlint check result
exit $?